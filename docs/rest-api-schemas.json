{
  "$schema": "https://json-schema.org/draft/2020-12/schema",
  "$id": "https://mhuxd.local/api/v1/schemas",
  "title": "mhuxd REST API Schemas",
  "type": "object",
  "definitions": {
    "Metadata": {
      "$id": "https://mhuxd.local/api/v1/schemas/metadata",
      "type": "object",
      "required": ["rigtypes", "devicetypes"],
      "properties": {
        "rigtypes": {
          "type": "array",
          "description": "Microham rig/id mapping.",
          "items": {"$ref": "#/$defs/RigType"}
        },
        "devicetypes": {
          "type": "array",
          "description": "List of supported device types.",
          "items": {"$ref": "#/$defs/DeviceType"}
        }
      },
      "additionalProperties": false
    },
    "Runtime": {
      "$id": "https://mhuxd.local/api/v1/schemas/runtime",
      "type": "object",
      "required": ["daemon", "hostname"],
      "properties": {
        "daemon": {
          "type": "object",
          "required": ["name", "version", "logfile", "pid", "uptimeSec"],
          "properties": {
            "name": {"type": "string"},
            "version": {"type": "string"},
            "logfile": {"type": "string"},
            "pid": {"type": "integer"},
            "uptimeSec": {"type": "integer", "minimum": 0}
          },
          "additionalProperties": false
        },
        "hostname": {"type": "string"}
      },
      "additionalProperties": false
    },
    "Devices": {
      "$id": "https://mhuxd.local/api/v1/schemas/devices",
      "type": "object",
      "required": ["devices"],
      "properties": {
        "devices": {
          "type": "array",
          "items": {"$ref": "#/$defs/Device"}
        }
      },
      "additionalProperties": false
    },
    "Config": {
      "$id": "https://mhuxd.local/api/v1/schemas/config",
      "type": "object",
      "required": ["daemon", "keyers"],
      "properties": {
        "daemon": {
          "type": "object",
          "required": ["loglevel"],
          "properties": {
            "loglevel": {"type": "string"}
          },
          "additionalProperties": true
        },
        "keyers": {
          "type": "array",
          "items": {"$ref": "#/$defs/KeyerConfig"}
        }
      },
      "additionalProperties": false
    }
  },
  "$defs": {
    "RigType": {
      "type": "object",
      "required": ["id", "name", "icomAddr"],
      "properties": {
        "id": {"type": "integer"},
        "name": {"type": "string"},
        "icomAddr": {"type": "integer", "minimum": 0}
      },
      "additionalProperties": false
    },
    "Device": {
      "type": "object",
      "required": ["serial"],
      "properties": {
        "serial": {"type": "string"},
        "status": {"type": "string"},
        "verFwMajor": {"type": "integer"},
        "verFwMinor": {"type": "integer"},
        "verFwBeta": {"type": "boolean"},
        "verWinkey": {"type": "integer"}
      },
      "additionalProperties": false
    },
    "KeyerConfig": {
      "type": "object",
      "required": ["serial", "type"],
      "properties": {
        "serial": {"type": "string"},
        "type": {"type": "integer"},
        "channel": {"type": "object"},
        "param": {"type": "object"},
        "winkey": {"type": "object"},
        "cwMessages": {
          "type": "array",
          "items": {"$ref": "#/$defs/Message"}
        },
        "fskMessages": {
          "type": "array",
          "items": {"$ref": "#/$defs/Message"}
        },
        "sm": {"type": "object"}
      },
      "additionalProperties": true
    },
    "Message": {
      "type": "object",
      "required": ["index", "text"],
      "properties": {
        "index": {"type": "integer", "minimum": 1},
        "text": {"type": "string"}
      },
      "additionalProperties": false
    },
    "DisplayOption": {
      "type": "object",
      "required": ["value", "display"],
      "properties": {
        "value": {
          "oneOf": [
            {"type": "integer"},
            {"type": "string"}
          ]
        },
        "display": {"type": "string"}
      },
      "additionalProperties": false
    },
    "DeviceType": {
      "type": "object",
      "required": ["type", "name", "flags"],
      "properties": {
        "type": {"type": "integer"},
        "name": {"type": "string"},
        "flags": {
          "type": "array",
          "items": {"type": "string"}
        },
        "displaybackground": {
          "type": "array",
          "items": {"$ref": "#/$defs/DisplayOption"}
        },
        "displayevent": {
          "type": "array",
          "items": {"$ref": "#/$defs/DisplayOption"}
        }
      },
      "additionalProperties": false
    }
  }
}
